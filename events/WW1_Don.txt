add_namespace = ww1_don

#kaledin does kys
country_event = {
	title = ww1_don.1.t
	desc = ww1_don.1.d
	id = ww1_don.1
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
	mean_time_to_happen = {
		days = 3
	}
	trigger = {
		tag = DON
		has_country_leader = {
			character = RUS_alexei_kaledin
			ruling_only = no
		}
        NOT = {
            controls_province = 9417
        }
	}
	option = {
		name = ww1_don.1.a		
		retire_character = RUS_alexei_kaledin
        hidden_effect = {
            RUS_pyotr_krasnov = {
                add_country_leader_role ={
                    promote_leader = yes
                    country_leader = {
                        ideology=stratocracy
                    }
                }
                add_country_leader_role ={
                    promote_leader = yes
                    country_leader = {
                        ideology=oligarchism
                    }
                }
            }
			SOV = {
				country_event = {
					id = ww1_don.6
					days = 3
				}
			}
        }
	}
}
#Soviet confiscate food, don rises up
country_event = {
	title = ww1_don.2.t
	desc = ww1_don.2.d
	id = ww1_don.2
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
	trigger = {
        country_exists = DON
		tag = DON
        has_capitulated = yes
		SOV = {
			has_completed_focus = SOV_decree_on_food_dictatorship
		}
	}
	option = {
		name = ww1_don.2.a		
        hidden_effect = {
            country_event = {
                id = ww1_don.3
                days = 14
            }
			218 = {
				create_unit = {
					division = "division_template = \"Pekhotnaya Diviziya\" start_experience_factor = 0.4 start_equipment_factor = 1"
					owner = DON
					allow_spawning_on_enemy_provs = yes
					count = 5
				}
			}
        }
	}
}
#Don receives weapons from Germany
country_event = {
	title = ww1_don.3.t
	desc = ww1_don.3.d
	id = ww1_don.3
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	trigger = {
        GER = {
            NOT = {
                has_war_with = RUS
            }
        }
	}
	option = {
		name = ww1_don.3.a		
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 2500
			producer = GER
		}
	}
}
#Soviet Invasion - SOV
country_event = {
	title = ww1_don.4.t
	desc = ww1_don.4.d
	id = ww1_don.4
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_don.4.a
		declare_war_on = {
			target = DON
			type = civil_war
		}		
		hidden_effect = {
			DON = {
				country_event = {
					id = ww1_don.5
					days = 2
				}
			}
		}
	}
}
#Soviet Invasion - DON
country_event = {
	title = ww1_don.5.t
	desc = ww1_don.5.d
	id = ww1_don.5
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_don.5.a		
		hidden_effect = {
			WML = {
				add_to_faction = DON
				add_to_war = {
					targeted_alliance = DON
					enemy = RUS
					hostility_reason = asked_to_join
				}
			}
		}
	}
}
#DON SR
country_event = {
	title = ww1_don.6.t
	desc = ww1_don.6.d
	id = ww1_don.6
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
	is_triggered_only = yes
    # trigger = {
	# 	tag = SOV
	# 	DON = {
	# 		has_capitulated = yes
	# 	}
	# }
	# mean_time_to_happen = {
	# 	days = 3
	# }
	option = {
		name = ww1_don.6.a		
		hidden_effect = {
			DON = {
				start_civil_war = {
					ideology = communism
					size = 0.2
					capital = 3147
					states = {
						238
						265
						245
					}
					transfer_state = 265
					set_state_controller = 238
					set_state_controller = 245
					keep_all_characters = yes
					add_ideas = standing_alone	
					set_country_flag = DON_sr
					division_template = {
						name = "Red Guards"
						division_names_group = SOV_INF_01
						regiments = {
							militia = { x = 0 y = 0 }
							militia = { x = 0 y = 1 }
							militia = { x = 1 y = 0 }
							militia = { x = 1 y = 1 }
						}
					}
					265 = {
						create_unit = {
							division = "division_template = \"Red Guards\" start_experience_factor = 0.2" 
							owner = DSR
							allow_spawning_on_enemy_provs = yes
							count = 3
						}
					}
					every_state = {
						limit = {
							is_core_of = DON
						}
						add_core_of = DSR
					}
				}
			}
			SOV = {
				puppet = DSR
				# dont remove, might remove puppeting later
				add_to_faction = DSR
			}	
		}
	}
}